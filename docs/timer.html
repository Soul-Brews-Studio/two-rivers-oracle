<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Timer — PSRU Workshop</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Noto+Sans+Thai:wght@300;400;700&display=swap');
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    background: #0d1117;
    color: #e6edf3;
    font-family: 'Noto Sans Thai', sans-serif;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    overflow: hidden;
  }

  .timer-wrap { text-align: center; position: relative; z-index: 1; }

  .label {
    font-size: clamp(1rem, 3vw, 1.4rem);
    color: #8b949e;
    margin-bottom: 0.5rem;
  }

  .clock {
    font-family: 'JetBrains Mono', monospace;
    font-size: clamp(5rem, 20vw, 12rem);
    font-weight: 700;
    letter-spacing: 0.05em;
    background: linear-gradient(135deg, #58a6ff, #3fb950);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    line-height: 1;
    transition: opacity 0.3s;
  }
  .clock.warning {
    background: linear-gradient(135deg, #fbbf24, #f87171);
    -webkit-background-clip: text;
    background-clip: text;
    animation: pulse-text 1s ease infinite;
  }
  .clock.done {
    background: linear-gradient(135deg, #f87171, #ff6b6b);
    -webkit-background-clip: text;
    background-clip: text;
    animation: pulse-text 0.5s ease infinite;
  }
  @keyframes pulse-text {
    50% { opacity: 0.6; }
  }

  .sub-time {
    font-family: 'JetBrains Mono', monospace;
    font-size: clamp(0.8rem, 2vw, 1.1rem);
    color: #484f58;
    margin-top: 0.8rem;
  }

  .progress-wrap {
    width: min(80vw, 500px);
    height: 6px;
    background: #21262d;
    border-radius: 3px;
    margin: 1.5rem auto 0;
    overflow: hidden;
  }
  .progress-bar {
    height: 100%;
    border-radius: 3px;
    background: linear-gradient(90deg, #3fb950, #58a6ff);
    transition: width 1s linear;
  }
  .progress-bar.warning {
    background: linear-gradient(90deg, #f87171, #fbbf24);
  }

  .msg {
    margin-top: 1.5rem;
    font-size: clamp(1.2rem, 4vw, 2rem);
    font-weight: 700;
    opacity: 0;
    transition: opacity 0.5s;
  }
  .msg.show { opacity: 1; }

  /* Ring effect */
  .ring {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: min(70vw, 450px);
    height: min(70vw, 450px);
    border-radius: 50%;
    border: 2px solid rgba(88,166,255,0.1);
    pointer-events: none;
  }
  .ring:nth-child(2) { width: min(85vw, 550px); height: min(85vw, 550px); border-color: rgba(63,185,80,0.06); }
  .ring.warning { border-color: rgba(248,113,113,0.15); }

  footer {
    position: fixed;
    bottom: 12px;
    color: #484f58;
    font-size: 0.7rem;
    text-align: center;
  }
  footer span { color: #58a6ff; }
</style>
</head>
<body>

<div class="ring" id="ring1"></div>
<div class="ring" id="ring2"></div>

<div class="timer-wrap">
  <div class="label" id="label">Workshop Timer</div>
  <div class="clock" id="clock">20:00</div>
  <div class="sub-time" id="sub">10:50 → 11:15</div>
  <div class="progress-wrap"><div class="progress-bar" id="progress" style="width:100%"></div></div>
  <div class="msg" id="msg"></div>
</div>

<footer><span>Two Rivers (สองแคว)</span> — PSRU Workshop Timer</footer>

<script>
// ===== CONFIG =====
// Target end time: 2026-03-01 11:10:00 ICT (UTC+7)
const END_TIME = new Date('2026-03-01T11:15:00+07:00').getTime();
const DURATION = 25 * 60 * 1000; // 25 minutes in ms
const START_TIME = END_TIME - DURATION;

const clockEl = document.getElementById('clock');
const labelEl = document.getElementById('label');
const subEl = document.getElementById('sub');
const progressEl = document.getElementById('progress');
const msgEl = document.getElementById('msg');
const ring1 = document.getElementById('ring1');
const ring2 = document.getElementById('ring2');

let alarmPlayed = false;

function tick() {
  const now = Date.now();
  const remaining = END_TIME - now;
  const elapsed = now - START_TIME;
  const pct = Math.max(0, Math.min(100, (remaining / DURATION) * 100));

  if (now < START_TIME) {
    // Before start
    const untilStart = START_TIME - now;
    const m = Math.floor(untilStart / 60000);
    const s = Math.floor((untilStart % 60000) / 1000);
    clockEl.textContent = `${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
    clockEl.className = 'clock';
    labelEl.textContent = 'เริ่มใน / Starts in';
    progressEl.style.width = '100%';
    progressEl.className = 'progress-bar';
  } else if (remaining > 0) {
    // Counting down
    const m = Math.floor(remaining / 60000);
    const s = Math.floor((remaining % 60000) / 1000);
    clockEl.textContent = `${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
    progressEl.style.width = pct + '%';

    if (remaining <= 60000) {
      // Last minute
      clockEl.className = 'clock warning';
      progressEl.className = 'progress-bar warning';
      ring1.className = 'ring warning';
      ring2.className = 'ring warning';
      labelEl.textContent = 'เหลืออีกนิดเดียว! Almost done!';
    } else if (remaining <= 5 * 60000) {
      // Last 5 minutes
      clockEl.className = 'clock warning';
      progressEl.className = 'progress-bar warning';
      labelEl.textContent = 'เหลือไม่ถึง 5 นาที / Under 5 minutes';
    } else {
      clockEl.className = 'clock';
      progressEl.className = 'progress-bar';
      labelEl.textContent = 'Workshop Timer';
    }
  } else {
    // Done!
    clockEl.textContent = '00:00';
    clockEl.className = 'clock done';
    progressEl.style.width = '0%';
    progressEl.className = 'progress-bar warning';
    ring1.className = 'ring warning';
    ring2.className = 'ring warning';
    labelEl.textContent = 'หมดเวลา! Time\'s up!';
    msgEl.textContent = '⏰ กลับมารวมกันค่ะ! Come back together!';
    msgEl.className = 'msg show';

    if (!alarmPlayed) {
      alarmPlayed = true;
      // Beep using Web Audio
      try {
        const ac = new AudioContext();
        for (let i = 0; i < 3; i++) {
          const osc = ac.createOscillator();
          const gain = ac.createGain();
          osc.connect(gain);
          gain.connect(ac.destination);
          osc.frequency.value = 880;
          gain.gain.value = 0.3;
          osc.start(ac.currentTime + i * 0.4);
          osc.stop(ac.currentTime + i * 0.4 + 0.2);
        }
      } catch(e) {}
    }
  }
}

tick();
setInterval(tick, 200);
</script>
</body>
</html>
